app.post('/details', (req, res) => {
    // Extract form data
    const formData = req.body;
    // console.log("Form data:", formData);
    let message = "Form Data:\n";
    for (const key in formData) {
        if (formData.hasOwnProperty(key)) {
            message += `${key}: ${formData[key]}\n`;
        }
    }

    // Create reusable transporter object using the default SMTP transport
    let transporter = nodemailer.createTransport({
        service: 'gmail',
        auth: {
            user: 'bgmilelomujhse@gmail.com', // Replace with your Gmail email
            pass: 'zxyt vaqy qqqt loze' // Replace with your Gmail password
        }
    });

    // Construct email message
    let mailOptions = {
        from: 'bgmilelomujhse@gmail.com', // Replace with your Gmail email
        to: 'suryakantgupta678@gmail.com', // Replace with recipient's email
        subject: 'New Form Submission',
        text: message
    };

    // Send email
    transporter.sendMail(mailOptions, (error, info) => {
        if (error) {
            console.error("Error sending email:", error);
            res.status(500).send("Error sending email");
        } else {
            console.log("Email sent:", info.response);
            const referer = req.header('referer') || '/'; // Default to home page if referer is not present
            res.redirect(referer);
        }
    });
});
